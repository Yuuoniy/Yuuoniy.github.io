<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <title>CTF | 逆向入门第一篇 - Yuuoniy&#39;s blog</title>
    
    <meta name="description" content="跟着萌新一起逆向入门呦。包括：基本知识点,简单题例子,常见操作
先来过一遍知识点吧！
工具介绍  Disassembler 反汇编器 Tracer 记录运行的过程,如函数，指令 Debugger 调试器 Decompiler IDA、geb（支持mips、web assembly?) Emulator (qemu 模拟执行）知道CPU状态 Symbolic execution 符号执行 angr、路径爆炸  具体工具  IDA 支持脚本、手工定义的反汇编规则 Geb 逆安卓 mips web*** Binary ninja 不支持反编译,api好用，通常提供静态分析 R2 命令系统奇怪，支持以太坊智能合约 Retdec capstone  常规逆向 ELF/PE/Mach-O file with x86/x64/arm
此外还有一些非常常规逆向，比如&hellip;不说啦哈哈哈哈
逆向的一般步骤：信息收集-&gt;定位关键代码-&gt;分析*
信息收集 Strings(搜看看有没有源码..）/ binwalk file ida -&gt; google/github
例子
 CISCN 2018 re 酷狗音乐盒  定位关键代码  根据控制流 Data 交叉引用 代码交叉引用 Memory searching &#43;r/w breakpoint.输入数据 内存搜索 记录地址 对该地址下断点 读写断点（保证运行地址不变？） Tracing 例子：youku client reversing  分析代码 Tips">
    <meta name="author" content="">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css" rel="stylesheet">
    <link href="https://yuuoniy.github.io/an-old-hope.min.css" rel="stylesheet">
    <link href="https://yuuoniy.github.io/style.css" rel="stylesheet">
    <link href="https://yuuoniy.github.io/custom.css" rel="stylesheet">
    
    <link rel="apple-touch-icon" href="https://yuuoniy.github.io/apple-touch-icon.png">
    <link rel="icon" href="https://yuuoniy.github.io/favicon.ico">
    <meta name="generator" content="Hugo 0.76.5" />
    
    
    
    <script>
      function setTheme() {
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.body.classList.add('dark');
          return;
        }

        const time = new Date();
        const prev = localStorage.getItem('date');
        const date = String(time.getMonth() + 1) + '.' + String(time.getDate());

        const now = time.getTime();
        let sunrise;
        let sunset;

        function setBodyClass() {
          if (now > sunrise && now < sunset) return;
          document.body.classList.add('dark');
        }

        if (date !== prev) {
          fetch('https://api.ipgeolocation.io/astronomy?apiKey=5ed37d85103e4defa5df4c5298ed5215')
            .then((res) => res.json())
            .then((data) => {
              sunrise = data.sunrise.split(':').map(Number);
              sunset = data.sunset.split(':').map(Number);
            })
            .catch(() => {
              sunrise = [7, 0];
              sunset = [19, 0];
            })
            .finally(() => {
              sunrise = time.setHours(sunrise[0], sunrise[1], 0);
              sunset = time.setHours(sunset[0], sunset[1], 0);
              setBodyClass();
              localStorage.setItem('sunrise', sunrise);
              localStorage.setItem('sunset', sunset);
            });
          localStorage.setItem('date', date);
        } else {
          sunrise = Number(localStorage.getItem('sunrise'));
          sunset = Number(localStorage.getItem('sunset'));
          setBodyClass();
        }
      }
    </script>
  </head>
  <body class="single">
    <script>
      setTheme();
    </script>
    <header class="header">
      <nav class="nav">
        <p class="logo"><a href="https://yuuoniy.github.io/">Yuuoniy&#39;s blog</a></p>
        <ul class="menu">
          <li>
            <a href="/posts/">Posts</a>
          </li>
          <li>
            <a href="/tags/">Tags</a>
          </li>
          <li>
            <a href="/about/">About</a>
          </li>
          <li>
            <a href="/index.xml">RSS</a>
          </li>
        </ul>
      </nav>
    </header>
    <main class="main">

<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>
<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">CTF | 逆向入门第一篇</h1>
    <div class="post-meta">2018-08-03
    </div>
  </header>
  <div class="post-toc"></div>
  <div class="post-content article-post">
    <p>跟着萌新一起逆向入门呦。包括：基本知识点,简单题例子,常见操作</p>
<!-- raw HTML omitted -->
<p>先来过一遍知识点吧！</p>
<h4 id="工具介绍">工具介绍</h4>
<ul>
<li>Disassembler 反汇编器</li>
<li>Tracer 记录运行的过程,如函数，指令</li>
<li>Debugger 调试器</li>
<li>Decompiler IDA、geb（支持mips、web assembly?)</li>
<li>Emulator (qemu 模拟执行）知道CPU状态</li>
<li>Symbolic execution 符号执行 angr、路径爆炸</li>
</ul>
<h5 id="具体工具">具体工具</h5>
<ul>
<li>IDA 支持脚本、手工定义的反汇编规则</li>
<li>Geb 逆安卓 mips web***</li>
<li>Binary ninja 不支持反编译,api好用，通常提供静态分析</li>
<li>R2 命令系统奇怪，支持以太坊智能合约</li>
<li>Retdec</li>
<li>capstone</li>
</ul>
<p><strong>常规逆向</strong>
ELF/PE/Mach-O file with x86/x64/arm<br>
此外还有一些非常常规逆向，比如&hellip;不说啦哈哈哈哈<br>
逆向的一般步骤：<strong>信息收集-&gt;定位关键代码-&gt;分析</strong>*</p>
<h4 id="信息收集">信息收集</h4>
<p>Strings(搜看看有没有源码..）/ binwalk file ida -&gt; google/github<br>
<strong>例子</strong></p>
<ul>
<li>CISCN 2018 re</li>
<li>酷狗音乐盒</li>
</ul>
<h4 id="定位关键代码">定位关键代码</h4>
<ul>
<li>根据控制流</li>
<li>Data 交叉引用</li>
<li>代码交叉引用</li>
<li>Memory searching +r/w breakpoint.输入数据  内存搜索 记录地址 对该地址下断点 读写断点（保证运行地址不变？）</li>
<li>Tracing 
<strong>例子</strong>：youku client reversing</li>
</ul>
<h4 id="分析代码">分析代码</h4>
<p><strong>Tips</strong></p>
<ul>
<li>代码是人写的
<ul>
<li>区分库代码和程序代码 （库代码也不用仔细逆）</li>
<li>区分人写的和编译器加上的代码</li>
<li>不需要仔细逆向编译器加上的代码</li>
<li>Binary 由编译器生成
<ul>
<li>Binary layout pattern 即生成的程序有规律</li>
<li>|executable|lib1|lib2|lib3|</li>
<li>识别出编译器优化的代码</li>
</ul>
</li>
</ul>
</li>
<li>代码重用
<ul>
<li>String xref</li>
<li>Code style</li>
</ul>
</li>
<li>文件是可执行的
<ul>
<li>善用动态调试
<ul>
<li>找到关键代码，验证猜测</li>
<li>Debugging</li>
<li>Tracing</li>
<li>Symbolic execution</li>
<li>Taint analysis
• 七分猜</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>技巧：一块一块看而不是一行一行</strong></p>
<ul>
<li>常见算法（xxsearch ida 插件自动识别加密算法）
-Tea/Xtea/</li>
<li>常见数据结构</li>
<li>常见设计模式
-Proxy stub/工厂模式</li>
<li>常见框架</li>
</ul>
<h4 id="混淆">混淆</h4>
<h5 id="例子">例子：</h5>
<ul>
<li>Ollvm (平坦的控制流 主分发器）</li>
<li>ovfus。。 去掉分支</li>
<li>Push rax,ret (把所有的跳转 jump rax) mov rax 0x222, 模拟执行看rax 是什么 patch 掉啥？？</li>
<li>Vm/self modify code</li>
</ul>
<h5 id="解混淆">解混淆</h5>
<pre><code>• 知道混淆的原理，恢复控制流
• 模拟执行/符号执行
</code></pre>
<p>https://  <a href="https://security.tencent.com/index.php/blog/msg/112">https://security.tencent.com/index.php/blog/msg/112</a>
反混淆：搜索：符号执行 ollvm</p>
<h4 id="壳packer">壳（packer)</h4>
<h5 id="类型">类型：</h5>
<pre><code>• 解压-&gt;运行
• 解压-&gt;运行-&gt;解压..-&gt;运行
• 解压 decoder|encoded code-&gt;decode -&gt;exc
• Run the virtual machine 
</code></pre>
<h5 id="解决方法">解决方法</h5>
<ul>
<li>Case by case</li>
<li>Esp law (oep 找到？？)</li>
<li>Read /proc/[pid]/mem</li>
</ul>
<h4 id="反调试">反调试</h4>
<p>搜索：Windows  anti-debugging</p>
<h5 id="debugger-detection">Debugger detection</h5>
<ul>
<li>API call,isDebuggerPresent()</li>
<li>Try {int3},catch{}</li>
<li>Timestamp</li>
</ul>
<h5 id="debugger-interfering">Debugger Interfering</h5>
<ul>
<li>如果有内核权限 debugport overweite</li>
<li>Self debugging 父进程调试子进程</li>
</ul>
<p>大概是首先分析一下代码，并且使用IDA一波操作修改一下变量名、平衡堆栈、定义函数等就开始好逆。<br>
<strong>IDA的一些操作</strong>:</p>
<ul>
<li>修改变量名 N</li>
<li>修改函数类型</li>
<li>修改变量类型 Y(常见有修改为数组提高可读性)</li>
<li>数字转化为char R</li>
<li>Nop</li>
<li>Patch</li>
<li>取消/定义函数 U/P</li>
<li>交叉引用发现问题时，自己在函数处按P定义函数</li>
<li>修改函数结尾</li>
<li>脚本执行 (IDA portable版本中不支持python执行&hellip;)</li>
<li>修改函数结尾地址</li>
<li>查看并修改sp(options-&gt;general)</li>
<li>动态调试</li>
<li>options-&gt;complier 修改编译器</li>
<li>模糊符号匹配
快捷键需要熟悉噢！
<strong>插件</strong></li>
<li>lazyIDA dump 数据超方便</li>
<li>keypatch</li>
<li>rizoo</li>
</ul>
<p><strong>参考资料</strong></p>
<ul>
<li><a href="https://wenku.baidu.com/view/bb468fff910ef12d2af9e7c3.html">https://wenku.baidu.com/view/bb468fff910ef12d2af9e7c3.html</a><br>
下面就讲几道题叭！
源程序..有空再传到github上&hellip;需要可以直接找我呀</li>
</ul>
<h4 id="re0">re0</h4>
<p>首先需要对judge进行动态解密,解出来后修改judge函数尾(右键-&gt;edit function) U 取消定义 P定义函数,这样就能获得正确的judge函数啦！(因为IDA是程序一开始拖进来就分析好全部的函数栈帧了，因此这里不重新定义函数的话IDA的函数栈帧没有进行更新)</p>
<h5 id="动态解密">动态解密</h5>
<p>python 版</p>
<pre><code>import ida_bytes
buf = ida_bytes.get_bytes(0x600B00, 182)
a = &quot;&quot;
for i in xrange(0, len(buf)):
    a += chr(0xC ^ ord(buf[i]))
ida_bytes.patch_bytes(0x600B00, a)
</code></pre><p>idc 版</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;idc.idc&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#66d9ef">auto</span> cur <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x600B00</span>;
    <span style="color:#66d9ef">auto</span> i;
    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0xB5</span>; i<span style="color:#f92672">++</span>) {
        <span style="color:#66d9ef">auto</span> c <span style="color:#f92672">=</span> Byte(cur) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xC</span>;
        PatchByte(cur, c);
        cur <span style="color:#f92672">=</span> cur <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
    }
}
</code></pre></div><p>然后进行解密：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">flag_enc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;fmcd</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">k7d;V</span><span style="color:#ae81ff">\x60</span><span style="color:#e6db74">;np&#34;</span>
flag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(flag_enc)):
    c<span style="color:#f92672">=</span>flag_enc[i]
    flag<span style="color:#f92672">+=</span>chr(ord(c)<span style="color:#f92672">^</span>i)

<span style="color:#66d9ef">print</span> flag
</code></pre></div><h4 id="re1">RE1</h4>
<p>首先分析程序
尝试像atum那样直接patch 程序dump 出来..始终没弄清楚
直接使用OD动态看了
首先需要过掉长度的检查，因此输入长度需要为33
之后程序就可以执行下一验证逻辑
在00x401669 处下断点(F2)
可以依次得到flag</p>
<h4 id="simplecheck">simplecheck</h4>
<p>2018 强网杯的题
在jeb中打开，找到主代码逻辑，进行分析
首先定义a、b、c、d 四个各组
并且要求输入的字符串长度等于b 的长度，即34
接下来，创建数组V4，v4[0]=0，将输入的字符串添加到v4后面
后面是if验证 相当于一元二次方程，直接写脚本爆破即可，脚本如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> string <span style="color:#f92672">import</span> printable
a <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">146527998</span>, <span style="color:#ae81ff">205327308</span>, <span style="color:#ae81ff">94243885</span>, <span style="color:#ae81ff">138810487</span>, <span style="color:#ae81ff">408218567</span>, <span style="color:#ae81ff">77866117</span>, <span style="color:#ae81ff">71548549</span>, <span style="color:#ae81ff">563255818</span>, <span style="color:#ae81ff">559010506</span>, <span style="color:#ae81ff">449018203</span>, <span style="color:#ae81ff">576200653</span>, <span style="color:#ae81ff">307283021</span>, <span style="color:#ae81ff">467607947</span>, <span style="color:#ae81ff">314806739</span>, <span style="color:#ae81ff">341420795</span>, <span style="color:#ae81ff">341420795</span>, <span style="color:#ae81ff">469998524</span>, <span style="color:#ae81ff">417733494</span>, <span style="color:#ae81ff">342206934</span>, <span style="color:#ae81ff">392460324</span>, <span style="color:#ae81ff">382290309</span>, <span style="color:#ae81ff">185532945</span>, <span style="color:#ae81ff">364788505</span>, <span style="color:#ae81ff">210058699</span>, <span style="color:#ae81ff">198137551</span>, <span style="color:#ae81ff">360748557</span>, <span style="color:#ae81ff">440064477</span>, <span style="color:#ae81ff">319861317</span>, <span style="color:#ae81ff">676258995</span>, <span style="color:#ae81ff">389214123</span>, <span style="color:#ae81ff">829768461</span>, <span style="color:#ae81ff">534844356</span>, <span style="color:#ae81ff">427514172</span>, <span style="color:#ae81ff">864054312</span>];
b <span style="color:#f92672">=</span> [<span style="color:#ae81ff">13710</span>, <span style="color:#ae81ff">46393</span>, <span style="color:#ae81ff">49151</span>, <span style="color:#ae81ff">36900</span>, <span style="color:#ae81ff">59564</span>, <span style="color:#ae81ff">35883</span>, <span style="color:#ae81ff">3517</span>, <span style="color:#ae81ff">52957</span>, <span style="color:#ae81ff">1509</span>, <span style="color:#ae81ff">61207</span>, <span style="color:#ae81ff">63274</span>, <span style="color:#ae81ff">27694</span>, <span style="color:#ae81ff">20932</span>, <span style="color:#ae81ff">37997</span>, <span style="color:#ae81ff">22069</span>, <span style="color:#ae81ff">8438</span>, <span style="color:#ae81ff">33995</span>, <span style="color:#ae81ff">53298</span>, <span style="color:#ae81ff">16908</span>, <span style="color:#ae81ff">30902</span>, <span style="color:#ae81ff">64602</span>, <span style="color:#ae81ff">64028</span>, <span style="color:#ae81ff">29629</span>, <span style="color:#ae81ff">26537</span>, <span style="color:#ae81ff">12026</span>, <span style="color:#ae81ff">31610</span>, <span style="color:#ae81ff">48639</span>, <span style="color:#ae81ff">19968</span>, <span style="color:#ae81ff">45654</span>, <span style="color:#ae81ff">51972</span>, <span style="color:#ae81ff">64956</span>, <span style="color:#ae81ff">45293</span>, <span style="color:#ae81ff">64752</span>, <span style="color:#ae81ff">37108</span>];
c <span style="color:#f92672">=</span> [<span style="color:#ae81ff">38129</span>, <span style="color:#ae81ff">57355</span>, <span style="color:#ae81ff">22538</span>, <span style="color:#ae81ff">47767</span>, <span style="color:#ae81ff">8940</span>, <span style="color:#ae81ff">4975</span>, <span style="color:#ae81ff">27050</span>, <span style="color:#ae81ff">56102</span>, <span style="color:#ae81ff">21796</span>, <span style="color:#ae81ff">41174</span>, <span style="color:#ae81ff">63445</span>, <span style="color:#ae81ff">53454</span>, <span style="color:#ae81ff">28762</span>, <span style="color:#ae81ff">59215</span>, <span style="color:#ae81ff">16407</span>, <span style="color:#ae81ff">64340</span>, <span style="color:#ae81ff">37644</span>, <span style="color:#ae81ff">59896</span>, <span style="color:#ae81ff">41276</span>, <span style="color:#ae81ff">25896</span>, <span style="color:#ae81ff">27501</span>, <span style="color:#ae81ff">38944</span>, <span style="color:#ae81ff">37039</span>, <span style="color:#ae81ff">38213</span>, <span style="color:#ae81ff">61842</span>, <span style="color:#ae81ff">43497</span>, <span style="color:#ae81ff">9221</span>, <span style="color:#ae81ff">9879</span>, <span style="color:#ae81ff">14436</span>, <span style="color:#ae81ff">60468</span>, <span style="color:#ae81ff">19926</span>, <span style="color:#ae81ff">47198</span>, <span style="color:#ae81ff">8406</span>, <span style="color:#ae81ff">64666</span>];
d <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">341994984</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">370404060</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">257581614</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">494024809</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">135267265</span>, <span style="color:#ae81ff">54930974</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">155841406</span>, <span style="color:#ae81ff">540422378</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">107286502</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">128056922</span>, <span style="color:#ae81ff">265261633</span>, <span style="color:#ae81ff">275964257</span>, <span style="color:#ae81ff">119059597</span>, <span style="color:#ae81ff">202392013</span>, <span style="color:#ae81ff">283676377</span>, <span style="color:#ae81ff">126284124</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">68971076</span>, <span style="color:#ae81ff">261217574</span>, <span style="color:#ae81ff">197555158</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">12893337</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">10293675</span>, <span style="color:#ae81ff">93868075</span>, <span style="color:#ae81ff">121661845</span>, <span style="color:#ae81ff">167461231</span>, <span style="color:#ae81ff">123220255</span>, <span style="color:#ae81ff">221507</span>, <span style="color:#ae81ff">258914772</span>, <span style="color:#ae81ff">180963987</span>, <span style="color:#ae81ff">107841171</span>, <span style="color:#ae81ff">41609001</span>, <span style="color:#ae81ff">276531381</span>, <span style="color:#ae81ff">169983906</span>, <span style="color:#ae81ff">276158562</span>];
flag<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(c)):
  <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> printable:
    <span style="color:#66d9ef">if</span>(a[i]<span style="color:#f92672">==</span>b[i]<span style="color:#f92672">*</span>ord(j)<span style="color:#f92672">*</span>ord(j)<span style="color:#f92672">+</span>c[i]<span style="color:#f92672">*</span>ord(j)<span style="color:#f92672">+</span>d[i]):
      flag<span style="color:#f92672">+=</span>j
flag<span style="color:#f92672">+=</span><span style="color:#e6db74">&#34;}&#34;</span>
<span style="color:#66d9ef">print</span> flag
</code></pre></div><h4 id="evr1">Evr1</h4>
<p>对输入的flag进行加密，与已知的密文比较。分析程序看到许多反编译的以及干扰的，提取出关键部分,flag主要分为5部分，进行了4次变换，第一次变换，对于flag的每个字符。后面3次变换均为7字符</p>
<ul>
<li>变换0：对flag进行变换，存到flag_tr0 中</li>
<li>变换1：对flag_str0的7-13进行变换，存到flag_str1[0-7]</li>
<li>变换2：对flag_str0的14-20进行变换，存到flag_str2[0-6]</li>
<li>变换3 :对flag_str0的21-27进行变换，存到flag_str3[0-6]<br>
flag、flag_str0、byte_xxxx … 在地址上连续<br>
对flag_tr0分段赋值<br>
比较flag_tr0与密文，相等即可，比较位数为35<br>
因此使用脚本爆破即可</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">flag_enc<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x1E</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0xDD</span>, <span style="color:#ae81ff">0xDD</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0xD7</span>, <span style="color:#ae81ff">0x2E</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xFE</span>, <span style="color:#ae81ff">0x6A</span>, <span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0xF2</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x9A</span>, <span style="color:#ae81ff">0x4D</span>, <span style="color:#ae81ff">0x8B</span>, <span style="color:#ae81ff">0x4B</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x8A</span>, <span style="color:#ae81ff">0x4F</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x4F</span>, <span style="color:#ae81ff">0x14</span>,<span style="color:#ae81ff">0xb</span>];
flag<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>
<span style="color:#75715e">#变换 0</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
  flag<span style="color:#f92672">+=</span>chr(flag_enc[i]<span style="color:#f92672">^</span><span style="color:#ae81ff">0x76</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
  <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x20</span>,<span style="color:#ae81ff">0x7f</span>):
    originc <span style="color:#f92672">=</span> c
    c <span style="color:#f92672">=</span> c<span style="color:#f92672">^</span><span style="color:#ae81ff">0x76</span><span style="color:#f92672">^</span><span style="color:#ae81ff">0xAD</span>;
    c <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>c<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xAA</span><span style="color:#f92672">|</span>((c<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xAA</span>)<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">if</span>(c<span style="color:#f92672">==</span>flag_enc[i<span style="color:#f92672">+</span><span style="color:#ae81ff">7</span>]):
      flag<span style="color:#f92672">+=</span>chr(originc)


<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
  <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x20</span>,<span style="color:#ae81ff">0x7f</span>):
    originc <span style="color:#f92672">=</span> c
    c <span style="color:#f92672">=</span> c<span style="color:#f92672">^</span><span style="color:#ae81ff">0x76</span><span style="color:#f92672">^</span><span style="color:#ae81ff">0xBE</span>;
    c <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">*</span>c<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xCC</span><span style="color:#f92672">|</span>((c<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xCC</span>)<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">2</span>)
    <span style="color:#66d9ef">if</span>(c<span style="color:#f92672">==</span>flag_enc[i<span style="color:#f92672">+</span><span style="color:#ae81ff">14</span>]):
      flag<span style="color:#f92672">+=</span>chr(originc)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
  <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x20</span>,<span style="color:#ae81ff">0x7f</span>):
    originc <span style="color:#f92672">=</span> c
    c <span style="color:#f92672">=</span> c<span style="color:#f92672">^</span><span style="color:#ae81ff">0x76</span><span style="color:#f92672">^</span><span style="color:#ae81ff">0xEF</span>;
    c <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span><span style="color:#f92672">*</span>c<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xF0</span><span style="color:#f92672">|</span>((c<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xF0</span>)<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">4</span>)
    <span style="color:#66d9ef">if</span>(c<span style="color:#f92672">==</span>flag_enc[i<span style="color:#f92672">+</span><span style="color:#ae81ff">21</span>]):
      flag<span style="color:#f92672">+=</span>chr(originc)

  
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
  flag<span style="color:#f92672">+=</span>chr(flag_enc[i<span style="color:#f92672">+</span><span style="color:#ae81ff">28</span>]<span style="color:#f92672">^</span><span style="color:#ae81ff">0x76</span>)

<span style="color:#66d9ef">print</span> flag
</code></pre></div><p>hctf{&raquo;D55_CH0CK3R_B0o0M!-9193a09b}
嘤嘤嘤我实在是懒得传图<br>
有些地方偷了些懒，有问题可以联系我噢，应该有错的，也会随着日后学习中进行修补。</p>

  </div>
  <footer class="post-footer">
  </footer>
</article>

<script type="text/javascript">
  tocbot.init({
      
      tocSelector: '.post-toc',
      
      contentSelector: '.post-content',
      
      headingSelector: 'h1, h2, h3, h4',
      
      positionFixedSelector: '.post-toc',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
      scrollSmooth: true,
  });
  tocbot.refresh();
</script></main>
<footer class="footer">
	<span>
		Copyright © 2020–2020, Yuuoniy and the Hugo Authors; all rights reserved.
		
	</span>
	<span>&middot;</span>
	<span>Powered by <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>️ and <a href="https://gitlab.com/hugo-plains/hugo-plains" rel="noopener" target="_blank">Plains</a></span>
</footer>
<script src="https://yuuoniy.github.io/highlight.min.js"></script>
<script>
	hljs.initHighlightingOnLoad();
</script>
</body>
</html>

